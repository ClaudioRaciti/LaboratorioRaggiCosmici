#include <iostream>           // ci serve per stampare a video il testo
#include <TGraphErrors.h>     // ci serve per istanziare grafici
#include <TAxis.h>            // ci serve per manipolare gli assi dei grafici
#include <TCanvas.h>          // ci serve per disegnare i grafici
#include <TF1.h>              // ci serve per scrivere le funzioni con cui fittare i grafici
#include <iomanip>            // ci serve per manipolare l'output a video
#include <cmath>

using namespace std;


// Corpo del programma. La funzione qui sotto deve avere lo stesso nome del file .C
void esperienza_3()
{

const int nmisure1 = 42;
const int nmisure2 = 45;
//PASSA ALTO

float G1 [] = {0.042222222,
0.077083333,
0.113888889,
0.15,
0.188888889,
0.243055556,
0.3,
0.352777778,
0.419444444,
0.454794521,
0.495238095,
0.527891156,
0.575342466,
0.602739726,
0.630136986,
0.652054795,
0.684137931,
0.703448276,
0.724137931,
0.737931034,
0.75862069,
0.784722222,
0.791666667,
0.804195804,
0.819444444,
0.819444444,
0.846153846,
0.853146853,
0.867132867,
0.88028169,
0.887323944,
0.908450704,
0.915492958,
0.922535211,
0.936619718,
0.950704225,
0.971830986,
0.985815603,
0.992907801,
0.992907801,
0.992907801,
1
};


float G1_err [] = {0.001817846,
0.00350725,
0.007631091,
0.008098544,
0.008703758,
0.009685486,
0.016197089,
0.016997916,
0.018128776,
0.018517752,
0.019149596,
0.019784934,
0.020883452,
0.021455662,
0.022038582,
0.022512071,
0.023375867,
0.023808023,
0.024275482,
0.024589544,
0.02506409,
0.025846606,
0.026009497,
0.026488357,
0.026665064,
0.026665064,
0.027492055,
0.027660638,
0.02799886,
0.028517504,
0.028690162,
0.029210095,
0.02938404,
0.029558293,
0.0299077,
0.030258275,
0.030786238,
0.03135788,
0.031537448,
0.031537448,
0.031537448,
0.031717276
};

float f [] = {200.4,
400,
595.9,
801.3,
1020,
1351,
1701,
2037,
2451,
2738,
3075,
3397,
3771,
4107,
4422,
4794,
5086,
5427,
5714,
6070,
6410,
6736,
7082,
7420,
7776,
8052,
8591,
9058,
9524,
9950,
11010,
12050,
13050,
14180,
15080,
20650,
25900,
40950,
66700,
98070,
146200,
200400
};

float f_err [] = {0.2004,
0.4,
0.5959,
0.8013,
1.02,
1.351,
1.701,
2.037,
2.451,
2.738,
3.075,
3.397,
3.771,
4.107,
4.422,
4.794,
5.086,
5.427,
5.714,
6.07,
6.41,
6.736,
7.082,
7.42,
7.776,
8.052,
8.591,
9.058,
9.524,
9.95,
11.01,
12.05,
13.05,
14.18,
15.08,
20.65,
25.9,
40.95,
66.7,
98.07,
146.2,
200.4
};
/*
//Grafico passa alto
TCanvas *cG1f = new TCanvas("cG1f","A(f)",200,10,600,400);
  cG1f->SetLogx(1);
  cG1f->SetFillColor(0);
  cG1f->cd();
  TGraphErrors *gG1f = new TGraphErrors(nmisure1,f,G1,f_err,G1_err);
  gG1f->SetMarkerSize(0.6);
  gG1f->SetMarkerStyle(21);
  gG1f->SetTitle("A(f)");
  gG1f->GetXaxis()->SetTitle("log(f)");
  gG1f->GetYaxis()->SetTitle("A");
  gG1f->Draw("AP");


cout << "\n\n --- Ipotesi  x/(pow(pow(x,2) + [0],0.5)) --- \n" <<endl;

TF1 *funz1 = new TF1("funz1","x/(pow(pow(x,2) + [0],0.5))",0,250000);
gG1f->Fit(funz1,"RM+");
funz1->SetParameter(0,29484900);
cout << "Chi^2:" << funz1->GetChisquare() << ", number of DoF: " << funz1->GetNDF() << " (Probability: " << funz1->GetProb() << ")." << endl;
*/
//PASSA BASSO

float G2 [] = {1,
1,
0.993006993,
0.993006993,
0.979020979,
0.965034965,
0.951048951,
0.937062937,
0.902097902,
0.890410959,
0.863013699,
0.835616438,
0.815068493,
0.8,
0.772413793,
0.744827586,
0.724137931,
0.703448276,
0.684137931,
0.666666667,
0.64,
0.632167832,
0.611111111,
0.583333333,
0.570629371,
0.559440559,
0.542657343,
0.514685315,
0.492307692,
0.478873239,
0.450704225,
0.422535211,
0.388732394,
0.36056338,
0.338028169,
0.26056338,
0.211267606,
0.174468085,
0.137142857,
0.11,
0.093571429,
0.069285714,
0.055886525,
0.039285714,
0.030921986
};

float G2_err [] = {0.039558421,
0.039558421,
0.039420348,
0.039420348,
0.039145672,
0.038872993,
0.038602352,
0.038333794,
0.037671797,
0.036684018,
0.036189205,
0.035703317,
0.035344979,
0.035327582,
0.034857255,
0.034397336,
0.034059479,
0.033727897,
0.033424247,
0.033384734,
0.032752159,
0.033092649,
0.032554048,
0.032158435,
0.032205729,
0.032051767,
0.031825199,
0.031459529,
0.031178045,
0.031232306,
0.030897881,
0.030580394,
0.030222515,
0.017364682,
0.017001185,
0.010171834,
0.009220093,
0.008648487,
0.008147025,
0.004247448,
0.003912889,
0.003475924,
0.002127339,
0.001816785,
0.001667779
};

float f1 [] = {205,
400.6,
601,
775,
1018,
1361,
1702,
2033,
2457,
2743,
3070,
3425,
3788,
4065,
4425,
4780,
5095,
5391,
5714,
6075,
6418,
6748,
7052,
7439,
7800,
8052,
8547,
9074,
9572,
10070,
11060,
11980,
13040,
14080,
15060,
20020,
25210,
30900,
40620,
49900,
59770,
81170,
101500,
150500,
201200
};

float f1_err[] = {0.205,
0.4006,
0.601,
0.775,
1.018,
1.361,
1.702,
2.033,
2.457,
2.743,
3.07,
3.425,
3.788,
4.065,
4.425,
4.78,
5.095,
5.391,
5.714,
6.075,
6.418,
6.748,
7.052,
7.439,
7.8,
8.052,
8.547,
9.074,
9.572,
10.07,
11.06,
11.98,
13.04,
14.08,
15.06,
20.02,
25.21,
30.9,
40.62,
49.9,
59.77,
81.17,
101.5,
150.5,
201.2
};

//Grafico passa basso
TCanvas *cG2f = new TCanvas("cG2f","A(f)",200,10,600,400);
  cG2f->SetLogx(1);
  cG2f->SetFillColor(0);
  cG2f->cd();
  TGraphErrors *gG2f = new TGraphErrors(nmisure2,f1,G2,f1_err,G2_err);
  gG2f->SetMarkerSize(0.6);
  gG2f->SetMarkerStyle(21);
  gG2f->SetTitle("A(f)");
  gG2f->GetXaxis()->SetTitle("log(f)");
  gG2f->GetYaxis()->SetTitle("A");
  gG2f->Draw("AP");


cout << "\n\n --- Ipotesi  1/(pow(1 + pow(x,2)*[0],0.5)) --- \n" <<endl;

TF1 *funz2 = new TF1("funz2","1/(sqrt(1 + pow(x,2)*[0]))",0,250000);
funz2->SetParameter(0,pow(10., -8.));
funz2->SetParLimits(0,0.,pow(10., -5.));
gG2f->Fit(funz2,"RM+");
cout << "Chi^2:" << funz2->GetChisquare() << ", number of DoF: " << funz2->GetNDF() << " (Probability: " << funz2->GetProb() << ")." << endl;


}
